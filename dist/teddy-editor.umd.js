(function(g,P){typeof exports=="object"&&typeof module<"u"?module.exports=P(require("react")):typeof define=="function"&&define.amd?define(["react"],P):(g=typeof globalThis<"u"?globalThis:g||self,g.TeddyEditor=P(g.React))})(this,function(g){"use strict";var P={exports:{}},X={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe;function me(){if(oe)return X;oe=1;var e=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function i(n,c,a){var l=null;if(a!==void 0&&(l=""+a),c.key!==void 0&&(l=""+c.key),"key"in c){a={};for(var s in c)s!=="key"&&(a[s]=c[s])}else a=c;return c=a.ref,{$$typeof:e,type:n,key:l,ref:c!==void 0?c:null,props:a}}return X.Fragment=o,X.jsx=i,X.jsxs=i,X}var G={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var se;function ge(){return se||(se=1,process.env.NODE_ENV!=="production"&&function(){function e(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===v?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case J:return"Profiler";case Y:return"StrictMode";case y:return"Suspense";case _:return"SuspenseList";case x:return"Activity"}if(typeof r=="object")switch(typeof r.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),r.$$typeof){case D:return"Portal";case f:return(r.displayName||"Context")+".Provider";case V:return(r._context.displayName||"Context")+".Consumer";case T:var m=r.render;return r=r.displayName,r||(r=m.displayName||m.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return m=r.displayName||null,m!==null?m:e(r.type)||"Memo";case E:m=r._payload,r=r._init;try{return e(r(m))}catch{}}return null}function o(r){return""+r}function i(r){try{o(r);var m=!1}catch{m=!0}if(m){m=console;var h=m.error,w=typeof Symbol=="function"&&Symbol.toStringTag&&r[Symbol.toStringTag]||r.constructor.name||"Object";return h.call(m,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",w),o(r)}}function n(r){if(r===C)return"<>";if(typeof r=="object"&&r!==null&&r.$$typeof===E)return"<...>";try{var m=e(r);return m?"<"+m+">":"<...>"}catch{return"<...>"}}function c(){var r=j.A;return r===null?null:r.getOwner()}function a(){return Error("react-stack-top-frame")}function l(r){if(A.call(r,"key")){var m=Object.getOwnPropertyDescriptor(r,"key").get;if(m&&m.isReactWarning)return!1}return r.key!==void 0}function s(r,m){function h(){U||(U=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",m))}h.isReactWarning=!0,Object.defineProperty(r,"key",{get:h,configurable:!0})}function d(){var r=e(this.type);return I[r]||(I[r]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),r=this.props.ref,r!==void 0?r:null}function u(r,m,h,w,z,M,te,ne){return h=M.ref,r={$$typeof:H,type:r,key:m,props:M,_owner:z},(h!==void 0?h:null)!==null?Object.defineProperty(r,"ref",{enumerable:!1,get:d}):Object.defineProperty(r,"ref",{enumerable:!1,value:null}),r._store={},Object.defineProperty(r._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(r,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(r,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:te}),Object.defineProperty(r,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:ne}),Object.freeze&&(Object.freeze(r.props),Object.freeze(r)),r}function p(r,m,h,w,z,M,te,ne){var k=m.children;if(k!==void 0)if(w)if(S(k)){for(w=0;w<k.length;w++)b(k[w]);Object.freeze&&Object.freeze(k)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else b(k);if(A.call(m,"key")){k=e(r);var W=Object.keys(m).filter(function(Ge){return Ge!=="key"});w=0<W.length?"{key: someKey, "+W.join(": ..., ")+": ...}":"{key: someKey}",ue[k+w]||(W=0<W.length?"{"+W.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,w,k,W,k),ue[k+w]=!0)}if(k=null,h!==void 0&&(i(h),k=""+h),l(m)&&(i(m.key),k=""+m.key),"key"in m){h={};for(var re in m)re!=="key"&&(h[re]=m[re])}else h=m;return k&&s(h,typeof r=="function"?r.displayName||r.name||"Unknown":r),u(r,k,M,z,c(),h,te,ne)}function b(r){typeof r=="object"&&r!==null&&r.$$typeof===H&&r._store&&(r._store.validated=1)}var L=g,H=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),V=Symbol.for("react.consumer"),f=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.for("react.client.reference"),j=L.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A=Object.prototype.hasOwnProperty,S=Array.isArray,O=console.createTask?console.createTask:function(){return null};L={"react-stack-bottom-frame":function(r){return r()}};var U,I={},ee=L["react-stack-bottom-frame"].bind(L,a)(),de=O(n(a)),ue={};G.Fragment=C,G.jsx=function(r,m,h,w,z){var M=1e4>j.recentlyCreatedOwnerStacks++;return p(r,m,h,!1,w,z,M?Error("react-stack-top-frame"):ee,M?O(n(r)):de)},G.jsxs=function(r,m,h,w,z){var M=1e4>j.recentlyCreatedOwnerStacks++;return p(r,m,h,!0,w,z,M?Error("react-stack-top-frame"):ee,M?O(n(r)):de)}}()),G}var ae;function fe(){return ae||(ae=1,process.env.NODE_ENV==="production"?P.exports=me():P.exports=ge()),P.exports}var t=fe();/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,i,n)=>n?n.toUpperCase():i.toLowerCase()),le=e=>{const o=pe(e);return o.charAt(0).toUpperCase()+o.slice(1)},ce=(...e)=>e.filter((o,i,n)=>!!o&&o.trim()!==""&&n.indexOf(o)===i).join(" ").trim(),be=e=>{for(const o in e)if(o.startsWith("aria-")||o==="role"||o==="title")return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=g.forwardRef(({color:e="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:c="",children:a,iconNode:l,...s},d)=>g.createElement("svg",{ref:d,...xe,width:o,height:o,stroke:e,strokeWidth:n?Number(i)*24/Number(o):i,className:ce("lucide",c),...!a&&!be(s)&&{"aria-hidden":"true"},...s},[...l.map(([u,p])=>g.createElement(u,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=(e,o)=>{const i=g.forwardRef(({className:n,...c},a)=>g.createElement(ye,{ref:a,iconNode:o,className:ce(`lucide-${he(le(e))}`,`lucide-${e}`,n),...c}));return i.displayName=le(e),i};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=N("align-center",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=N("align-justify",[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=N("align-left",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=N("align-right",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=N("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=N("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=N("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=N("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=N("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=N("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=N("list-ordered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=N("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=N("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=N("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=N("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=N("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Z=(e,o,i)=>{const n=window.getSelection();if(!n||n.rangeCount===0||!o.current)return;const c=n.getRangeAt(0);if(c.toString())try{const a=()=>{let u=c.commonAncestorContainer;for(;u&&u!==o.current;){if(u.nodeType===Node.ELEMENT_NODE){const p=u;if(p.tagName.toLowerCase()===e.toLowerCase())return{isFormatted:!0,formatElement:p}}u=u.parentNode}return{isFormatted:!1,formatElement:null}},{isFormatted:l,formatElement:s}=a();let d=null;if(l&&s){const u=s.parentNode,p=document.createTextNode(s.textContent||"");u?.replaceChild(p,s),u?.normalize();const b=document.createRange();b.selectNodeContents(p),n.removeAllRanges(),n.addRange(b)}else{d=document.createElement(e);try{c.surroundContents(d);const u=document.createRange();u.selectNodeContents(d),n.removeAllRanges(),n.addRange(u)}catch{const p=c.extractContents();d.appendChild(p),c.insertNode(d);const b=document.createRange();b.selectNodeContents(d),n.removeAllRanges(),n.addRange(b)}}i()}catch(a){console.warn("Error applying format:",a),i()}},Ie=({editorRef:e,activeFormats:o,updateActiveFormats:i,getButtonClass:n})=>t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>Z("strong",e,i),className:n(o.bold),title:"Bold",children:t.jsx(ve,{size:18})}),t.jsx("button",{onClick:()=>Z("em",e,i),className:n(o.italic),title:"Italic",children:t.jsx(Re,{size:18})}),t.jsx("button",{onClick:()=>Z("u",e,i),className:n(o.underline),title:"Underline",children:t.jsx(Me,{size:18})}),t.jsx("button",{onClick:()=>Z("s",e,i),className:n(o.strikethrough),title:"Strikethrough",children:t.jsx(Se,{size:18})})]}),B=(e,o)=>{const i=window.getSelection();if(!i||i.rangeCount===0)return;let c=i.getRangeAt(0).commonAncestorContainer;for(;c&&c.nodeType!==Node.ELEMENT_NODE;)c=c.parentNode;if(c&&c.nodeType===Node.ELEMENT_NODE){const a=c;a.style.textAlign=e==="left"?"":e,o()}},Pe=({activeFormats:e,updateActiveFormats:o,getButtonClass:i})=>t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>B("left",o),className:i(e.alignLeft),title:"Align Left",children:t.jsx(we,{size:18})}),t.jsx("button",{onClick:()=>B("center",o),className:i(e.alignCenter),title:"Align Center",children:t.jsx(Ne,{size:18})}),t.jsx("button",{onClick:()=>B("right",o),className:i(e.alignRight),title:"Align Right",children:t.jsx(ke,{size:18})}),t.jsx("button",{onClick:()=>B("justify",o),className:i(e.alignJustify),title:"Justify",children:t.jsx(Ee,{size:18})})]}),ie=(e,o,i)=>{const n=window.getSelection();if(!n||n.rangeCount===0||!o.current)return;const c=n.getRangeAt(0);let a=c.commonAncestorContainer;a.nodeType===Node.TEXT_NODE&&(a=a.parentNode);let l=a;for(;l&&l!==o.current&&!["P","H1","H2","H3","H4","H5","H6","LI","UL","OL"].includes(l.tagName);)l=l.parentElement;if(!l||l===o.current){const s=document.createElement(e),d=document.createElement("li");d.textContent=n.toString()||"List item",s.appendChild(d),c.deleteContents(),c.insertNode(s);const u=document.createRange();u.setStart(d,0),u.setEnd(d,d.childNodes.length),n.removeAllRanges(),n.addRange(u)}else if(l.tagName==="LI"){const s=l.parentElement;if(s.tagName.toLowerCase()===e){const d=document.createElement("p");d.innerHTML=l.innerHTML,s.parentNode?.replaceChild(d,s)}else{const d=document.createElement(e);d.innerHTML=s.innerHTML,s.parentNode?.replaceChild(d,s)}}else{const s=document.createElement(e),d=document.createElement("li");d.innerHTML=l.innerHTML,s.appendChild(d),l.parentNode?.replaceChild(s,l)}i()},He=({editorRef:e,activeFormats:o,updateActiveFormats:i,getButtonClass:n})=>t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>{e?.current&&ie("ul",e,i)},className:n(o.bulletList),title:"Bullet List",children:t.jsx(Le,{size:18})}),t.jsx("button",{onClick:()=>{e?.current&&ie("ol",e,i)},className:n(o.numberedList),title:"Numbered List",children:t.jsx(Ae,{size:18})})]});let F=null;const Q=()=>{const e=window.getSelection();e&&e.rangeCount>0&&(F=e.getRangeAt(0).cloneRange())},K=()=>{if(F){const e=window.getSelection();e?.removeAllRanges(),e?.addRange(F)}},q=()=>{const e=window.getSelection();if(!e||e.rangeCount===0)return null;let i=e.getRangeAt(0).commonAncestorContainer;i.nodeType===Node.TEXT_NODE&&(i=i.parentNode);let n=i;for(;n&&n!==document.body;){if(n.nodeType===Node.ELEMENT_NODE){const c=n,a=c.tagName.toLowerCase();if(a==="a")return{type:"link",url:c.getAttribute("href")||"",text:c.textContent||""};if(a==="img")return{type:"image",src:c.getAttribute("src")||"",alt:c.getAttribute("alt")||""};if(a==="iframe")return{type:"video",src:c.getAttribute("src")||""}}n=n.parentNode}return null},ze=(e,o)=>{K();const i=window.getSelection();if(!i||i.rangeCount===0){const l=document.querySelector('[contenteditable="true"]');if(l){const s=document.createElement("a");s.href=e,s.textContent=o||e,s.target="_blank",s.rel="noopener noreferrer",s.className="text-blue-600 underline hover:text-blue-800",l.appendChild(s);const d=document.createTextNode(" ");l.appendChild(d);const u=document.createRange();u.setStartAfter(d),u.collapse(!0),i&&(i.removeAllRanges(),i.addRange(u))}return}const n=i.getRangeAt(0);let c=null,a=n.commonAncestorContainer;for(;a&&a!==document.body;){if(a.nodeType===Node.ELEMENT_NODE&&a.tagName.toLowerCase()==="a"){c=a;break}a=a.parentNode}if(c)c.setAttribute("href",e),c.textContent=o||e;else{const l=document.createElement("a");l.href=e,l.textContent=o||e,l.target="_blank",l.rel="noopener noreferrer",l.className="text-blue-600 underline hover:text-blue-800",n.deleteContents(),n.insertNode(l);const s=document.createRange();s.setStartAfter(l),s.collapse(!0),i.removeAllRanges(),i.addRange(s)}F=null},Ve=(e,o="Inserted image")=>{K();const i=window.getSelection();if(!i||i.rangeCount===0){const l=document.querySelector('[contenteditable="true"]');if(l){const s=document.createElement("img");s.src=e,s.alt=o,s.className="max-w-full h-auto rounded shadow-sm",l.appendChild(s);const d=document.createElement("br");l.appendChild(d);const u=document.createRange();u.setStartAfter(d),u.collapse(!0),i&&(i.removeAllRanges(),i.addRange(u))}return}const n=i.getRangeAt(0);let c=null,a=n.commonAncestorContainer;for(;a&&a!==document.body;){if(a.nodeType===Node.ELEMENT_NODE&&a.tagName.toLowerCase()==="img"){c=a;break}a=a.parentNode}if(c)c.setAttribute("src",e),c.setAttribute("alt",o);else{const l=document.createElement("img");l.src=e,l.alt=o,l.className="max-w-full h-auto rounded shadow-sm",n.deleteContents(),n.insertNode(l);const s=document.createRange();s.setStartAfter(l),s.collapse(!0),i.removeAllRanges(),i.addRange(s)}F=null},Ue=e=>{K();const o=window.getSelection();if(!o||o.rangeCount===0){const a=document.querySelector('[contenteditable="true"]');if(a){const l=document.createElement("iframe");l.src=e,l.width="560",l.height="315",l.className="max-w-full rounded shadow-sm",l.setAttribute("frameborder","0"),l.setAttribute("allowfullscreen","true"),a.appendChild(l);const s=document.createElement("br");a.appendChild(s);const d=document.createRange();d.setStartAfter(s),d.collapse(!0),o&&(o.removeAllRanges(),o.addRange(d))}return}const i=o.getRangeAt(0);let n=null,c=i.commonAncestorContainer;for(;c&&c!==document.body;){if(c.nodeType===Node.ELEMENT_NODE&&c.tagName.toLowerCase()==="iframe"){n=c;break}c=c.parentNode}if(n)n.setAttribute("src",e);else{const a=document.createElement("iframe");a.src=e,a.width="560",a.height="315",a.className="max-w-full rounded shadow-sm",a.setAttribute("frameborder","0"),a.setAttribute("allowfullscreen","true"),i.deleteContents(),i.insertNode(a);const l=document.createRange();l.setStartAfter(a),l.collapse(!0),o.removeAllRanges(),o.addRange(l)}F=null},Fe=({isOpen:e,onClose:o,onInsert:i,initialData:n})=>{const[c,a]=g.useState(""),[l,s]=g.useState("");g.useEffect(()=>{e&&n?(a(n.url),s(n.text)):e&&!n&&(a(""),s(""))},[e,n]);const d=u=>{u.preventDefault(),c.trim()&&(i(c.trim(),l.trim()),a(""),s(""),o())};return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:n?"Edit Link":"Insert Link"}),t.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:t.jsx($,{size:20})})]}),t.jsxs("form",{onSubmit:d,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL"}),t.jsx("input",{type:"url",value:c,onChange:u=>a(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com",required:!0,autoFocus:!0})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link Text (optional)"}),t.jsx("input",{type:"text",value:l,onChange:u=>s(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Link text"})]}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:n?"Update Link":"Insert Link"})]})]})]})}):null},De=({isOpen:e,onClose:o,onInsert:i,initialData:n})=>{const[c,a]=g.useState(""),[l,s]=g.useState(""),d=g.useRef(null);g.useEffect(()=>{e&&n?(a(n.alt),s(n.src)):e&&!n&&(a(""),s(""))},[e,n]);const u=L=>{const H=L.target.files?.[0];if(H){const D=new FileReader;D.onload=C=>{const Y=C.target?.result;i(Y,c||H.name),a(""),s(""),o(),d.current&&(d.current.value="")},D.readAsDataURL(H)}},p=()=>{n&&l&&(i(l,c),a(""),s(""),o())},b=()=>{d.current&&d.current.click()};return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:n?"Edit Image":"Insert Image"}),t.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:t.jsx($,{size:20})})]}),n&&t.jsxs("div",{className:"mb-4",children:[t.jsx("img",{src:l,alt:c,className:"max-w-full h-32 object-contain rounded border"}),t.jsx("button",{type:"button",onClick:b,className:"mt-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Replace Image"})]}),t.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:u,className:"hidden"}),!n&&t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image File"}),t.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alt Text (optional)"}),t.jsx("input",{type:"text",value:c,onChange:L=>a(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Image description",autoFocus:!!n})]}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{onClick:o,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n&&t.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Update Image"})]})]})}):null},Ye=({isOpen:e,onClose:o,onInsert:i,initialData:n})=>{const[c,a]=g.useState("");g.useEffect(()=>{e&&n?a(n.src):e&&!n&&a("")},[e,n]);const l=d=>{const u=d.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([\w-]+)/);if(u)return`https://www.youtube.com/embed/${u[1]}`;const p=d.match(/vimeo\.com\/(?:video\/)?(\d+)/);return p?`https://player.vimeo.com/video/${p[1]}`:d},s=d=>{if(d.preventDefault(),c.trim()){const u=l(c.trim());i(u),a(""),o()}};return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:n?"Edit Video":"Insert Video"}),t.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:t.jsx($,{size:20})})]}),t.jsxs("form",{onSubmit:s,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Video URL"}),t.jsx("input",{type:"url",value:c,onChange:d=>a(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"YouTube, Vimeo, or embed URL",required:!0,autoFocus:!0}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supports YouTube, Vimeo, and direct embed URLs"})]}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:n?"Update Video":"Insert Video"})]})]})]})}):null},Je=()=>{const[e,o]=g.useState(!1),[i,n]=g.useState(!1),[c,a]=g.useState(!1),[l,s]=g.useState(null),d=()=>{Q();const b=q();s(b?.type==="link"?b:null),o(!0)},u=()=>{Q();const b=q();s(b?.type==="image"?b:null),n(!0)},p=()=>{Q();const b=q();s(b?.type==="video"?b:null),a(!0)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:d,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Link",children:t.jsx(Te,{size:18})}),t.jsx("button",{onClick:u,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Image",children:t.jsx(_e,{size:18})}),t.jsx("button",{onClick:p,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Video",children:t.jsx(Oe,{size:18})})]}),t.jsx(Fe,{isOpen:e,onClose:()=>{o(!1),s(null)},onInsert:ze,initialData:l?.type==="link"?{url:l.url,text:l.text}:null}),t.jsx(De,{isOpen:i,onClose:()=>{n(!1),s(null)},onInsert:Ve,initialData:l?.type==="image"?{src:l.src,alt:l.alt}:null}),t.jsx(Ye,{isOpen:c,onClose:()=>{a(!1),s(null)},onInsert:Ue,initialData:l?.type==="video"?{src:l.src}:null})]})},We=()=>{const e=g.useRef(null),[o,i]=g.useState({bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,bulletList:!1,numberedList:!1}),[n,c]=g.useState("p"),[a,l]=g.useState(!1),[s,d]=g.useState(!1),[u,p]=g.useState(""),b=[{value:"p",label:"Paragraph",tag:"p"},{value:"h1",label:"Heading 1",tag:"h1"},{value:"h2",label:"Heading 2",tag:"h2"},{value:"h3",label:"Heading 3",tag:"h3"},{value:"h4",label:"Heading 4",tag:"h4"},{value:"h5",label:"Heading 5",tag:"h5"},{value:"h6",label:"Heading 6",tag:"h6"}],L=f=>{const T=window.getSelection();if(!T||T.rangeCount===0)return;const y=T.getRangeAt(0);let _=y.commonAncestorContainer;_.nodeType===Node.TEXT_NODE&&(_=_.parentNode);let R=null,E=_;for(;E&&E!==e.current;){if(E.nodeType===Node.ELEMENT_NODE){const x=E,v=x.tagName.toLowerCase();if(["p","h1","h2","h3","h4","h5","h6","div"].includes(v)){R=x;break}}E=E.parentNode}if(R&&R!==e.current){const x=document.createElement(f);x.innerHTML=R.innerHTML,R.style.textAlign&&(x.style.textAlign=R.style.textAlign),R.parentNode?.replaceChild(x,R),c(f),l(!1);const v=document.createRange();v.selectNodeContents(x),T.removeAllRanges(),T.addRange(v)}else{const x=document.createElement(f);if(y.toString())try{y.surroundContents(x)}catch{const j=y.extractContents();x.appendChild(j),y.insertNode(x)}else{x.innerHTML="<br>",y.insertNode(x);const v=document.createRange();v.setStart(x,0),v.collapse(!0),T.removeAllRanges(),T.addRange(v)}c(f),l(!1)}setTimeout(()=>C(),10)},H=()=>{if(e.current)if(s)e.current.innerHTML=u,e.current.contentEditable="true",d(!1);else{const f=e.current.innerHTML;p(f),e.current.contentEditable="false",e.current.textContent=f,d(!0)}},D=()=>{s&&e.current&&p(e.current.textContent||"")},C=()=>{const f=window.getSelection();if(!f||f.rangeCount===0)return;let y=f.getRangeAt(0).commonAncestorContainer;y.nodeType===Node.TEXT_NODE&&(y=y.parentNode);let _=y,R="p";for(;_&&_!==e.current;){if(["H1","H2","H3","H4","H5","H6","P"].includes(_.tagName)){R=_.tagName.toLowerCase();break}_=_.parentElement}c(R);let E=y,x=!1,v=!1;for(;E&&E!==e.current;){if(E.tagName==="UL"){x=!0;break}else if(E.tagName==="OL"){v=!0;break}E=E.parentElement}const j=U=>{let I=y;for(;I&&I!==e.current;){if(I.nodeType===Node.ELEMENT_NODE&&I.tagName.toLowerCase()===U.toLowerCase())return!0;I=I.parentNode}return!1};let A=y;for(;A&&A!==e.current;){if(A.nodeType===Node.ELEMENT_NODE){const U=A.tagName.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(U)){c(U);break}}A=A.parentNode}(A===e.current||!A)&&c("p");let S=y;for(;S&&S!==e.current&&S.nodeType!==Node.ELEMENT_NODE;)S=S.parentNode;const O=S&&S.nodeType===Node.ELEMENT_NODE?S.style.textAlign:"";i({bold:j("strong")||j("b"),italic:j("em")||j("i"),underline:j("u"),strikethrough:j("s")||j("strike")||j("del"),alignLeft:O===""||O==="left",alignCenter:O==="center",alignRight:O==="right",alignJustify:O==="justify",bulletList:x,numberedList:v})},Y=()=>{const f=window.getSelection();if(f&&f.rangeCount>0){const T=f.getRangeAt(0);e.current?.contains(T.commonAncestorContainer)&&C()}};g.useEffect(()=>(document.addEventListener("selectionchange",Y),()=>{document.removeEventListener("selectionchange",Y)}),[]);const J=f=>`p-2 rounded transition-colors ${f?"bg-blue-500 text-white hover:bg-blue-600":"hover:bg-gray-200"}`,V=()=>t.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"});return t.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",children:[t.jsxs("div",{className:"flex items-center gap-1 p-2 border border-gray-300 rounded-t-lg bg-gray-50",children:[t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>l(!a),className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded hover:bg-gray-100 min-w-[120px] justify-between",disabled:s,children:[t.jsx("span",{className:"text-sm",children:b.find(f=>f.value===n)?.label||"Paragraph"}),t.jsx(je,{size:14})]}),a&&!s&&t.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded shadow-lg z-10 min-w-[120px]",children:b.map(f=>t.jsx("button",{onClick:()=>L(f.tag),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 ${n===f.value?"bg-blue-50 text-blue-600":""}`,children:f.label},f.value))})]}),t.jsx(V,{}),t.jsx("div",{className:s?"opacity-50 pointer-events-none":"",children:t.jsx(Ie,{editorRef:e,activeFormats:{bold:o.bold,italic:o.italic,underline:o.underline,strikethrough:o.strikethrough},updateActiveFormats:C,getButtonClass:J})}),t.jsx(V,{}),t.jsx("div",{className:s?"opacity-50 pointer-events-none":"",children:t.jsx(Pe,{activeFormats:{alignLeft:o.alignLeft,alignCenter:o.alignCenter,alignRight:o.alignRight,alignJustify:o.alignJustify},updateActiveFormats:C,getButtonClass:J})}),t.jsx(V,{}),t.jsx("div",{className:s?"opacity-50 pointer-events-none":"",children:t.jsx(He,{editorRef:e,activeFormats:{bulletList:o.bulletList,numberedList:o.numberedList},updateActiveFormats:C,getButtonClass:J})}),t.jsx(V,{}),t.jsx("div",{className:s?"opacity-50 pointer-events-none":"",children:t.jsx(Je,{})}),t.jsx(V,{}),t.jsx("button",{onClick:H,className:J(s),title:s?"Switch to Visual View":"Switch to Code View",children:t.jsx(Ce,{size:16})})]}),t.jsx("div",{ref:e,contentEditable:!s,className:`overflow-auto w-full p-4 border border-gray-300 border-t-0 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s?"font-mono text-sm bg-gray-50 whitespace-pre-wrap":"prose prose-headings:mt-0 prose-headings:mb-2"}`,style:{whiteSpace:"pre-wrap"},onMouseUp:s?void 0:C,onKeyUp:s?void 0:C,onClick:()=>l(!1),onInput:s?D:void 0})]})};function Xe(){return t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsx(We,{})})}return Xe});
